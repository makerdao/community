# 紧急关停

## 什么是紧急关停?

紧急关停是 Dai 的一个重要安全功能，之前被称为全局清算。这一至关重要的安全功能可允许系统暂时关停。 [Dai](./dai.md) 持有者和 CDP 持有者可赎回系统中的抵押品。

## 紧急关停时会发生什么?

1. 激活紧急关停:
   如果 MKR 选民认为系统受到严重攻击，或者为了技术升级的紧急关停，可以激活。紧急关停会停止 CDP 的创建并冻结喂价。

2. 处理抵押赎回:
   紧急关停激活后，对于 Dai 持有者，可以立即赎回 ETH 抵押品。对于 CDP 持有者，需要等待一段时间，系统计算完剩余抵押品对应 CDP 比例后，CDP 持有者可以赎回一定数量的 ETH。

3. Dai 和 CDP 持有者赎回抵押品:
   Dai 持有者和 CDP 持有者开始直接用 Dai 和 CDP 交换与其资产价值相等的固定数量 ETH。

## 谁可以触发紧急关停?

在单抵押 Dai 中触发紧急关停的唯一方式是 MKR 持有者通过 [执行投票](./governance.md#投票的类型不止一种吗) 进行。

## 什么时候需要进行紧急关停?

在系统遭遇攻击，出现重大经济问题以及重大升级时需要进行紧急关停。

系统被攻击的情况包括黑客攻击、智能合约安全漏洞和预言机被操纵。

重大经济问题的情况包括严重脱锚（由 MKR 选民决定），以及其它对多数用户构成重大真正威胁的市场情况。

## 触及债务上限需要进行紧急关停吗?

触及债务上限意味着 CDP 持有者无法生成新的Dai，但这不是对系统稳定性的直接威胁。不过，如果不提高上限，需求可能会超过有限供给从而导致 Dai 的供需失衡。这个问题可以通过提高债务上限解决，无需触发系统紧急关停。紧急关停是非常具有破坏性的过程，作为最后手段或计划升级的情况下使用。

## CDP 和 Dai 的抵押品赎回是自动立即赎回还是手动触发的?

抵押赎回是手动触发的。

Dai 持有者可以在紧急关停后立即赎回抵押品。CDP 持有者在赎回抵押品之前需要等待6个小时的处理赎回期。

## 为什么 CDP 持有者在赎回抵押品之前有等待期?

处理 CDP 赎回涉及链上计算和资金变化。处理时间长短取决于网络情况，因此，默认设置时间为6小时。此延迟期也是为了预防可能出现的未知情况。

## MKR 选民可以将等待期设置为零吗?

时间设置较短会使 CDP 持有者面临赎回金额错误的风险。如果 CDP 持有者试图在处理完成之前关停 CDP 并从 PETH 退出到 WETH，可能会承担损失，此延迟期旨在保护 CDP 持有者本身的利益。

在发生紧急关停时，会先从 WETH 中转移部分 WETH 合并到 PETH 用于补偿 Dai 持有者。这会降低了 PETH 比率。如果用户在紧急关停的6小时延迟期内，试图将 PETH 转换成 WETH，可能会承受较低的 PETH 兑换比例。

## Dai 持有者需要赎回抵押品吗，还是仅仅CDP 持有者需要?

CDP 持有者和 Dai 持有者都需要赎回抵押品。不过 Dai 持有者可在紧急关停触发后立即赎回，CDP 持有者则需等待6个小时。

## 如果我是未创建 CDP 的 PETH 持有者，在紧急关停的情况下该怎么做?

当紧急关停被触发时，PETH 比率会暂时下降，并在处理 CDP 时恢复。因此，PETH 持有者需像 CDP 持有者一样等待6小时的延迟期。

## 如果抵押品价格在被冻结后持续下跌，这是否意味着Dai 和 CDP 持有者赎回的抵押品低于\$1?

是的，用户可能会获得价值低于1美元的抵押品。Dai 持有者可以立即赎回他们的抵押品，但可能会出现很小的滑价。CDP 持有者必须等待6小时的延迟期才能赎回，因此，在6小时内可能也可能会面临标的抵押品价格变动的风险。

## 触发紧急关停的执行速度?

要触发紧急关停，需由 MKR 选民进行执行投票。依据 [持续批准投票](./governance.md#什么是持续同意投票) 规则，该提案需要获得足够的 MKR，胜过之前的提案。因此，紧急关停的执行速度取决于 MKR 选民投票超过之前提案的速度。

## MakerDAO 在紧急关停后会发生什么?

在紧急关停触发后，会进行抵押品赎回流程。同时任何人都可以决定是否重新部署系统，以及如何部署。

## 谁可以重新部署系统?

因为是开源软件，任何人都可以重新部署。

## 如果出现多个重新部署，谁决定哪一个是官方的呢?

根据每个重新部署的细节，市场本身以及不同系统参与者会选择一个最合适的部署。参考因素包括：

- 无不合理的代码更改
- MKR 的代币分布
- 风险参数

## 谁决定系统如何重新部署?

因为它是开源软件，任何人都可以决定。理想情况下，重新部署的参数取决于紧急关停的原因，不应单方面或随意改变。以下是在重新部署时进行框架更改的粗略例子：

| 原因 | 解决方案 |
| --- | --- |
| 治理攻击 | 在重新部署中清除恶意 MKR 持有者，按照原样重新部署系统 |
| 预言机攻击     | 清除预言机模块并换上一个带有漏洞修复的新模块，按照原样重新部署系统 |
| 市场黑天鹅 | 按照原样重新部署系统，由 MKR 选民依据重新部署后的新优化系统机制决定如何消除这一风险   |

## 在紧急关停期间，CDP 持有者的抵押品会被转让给其他人吗?

在紧急关停期间，抵押品会优先给 Dai 持有者立即赎回。Dai 持有者可能会获得 CDP 持有者的部分原始抵押品。而在 CDP 持有者可赎回抵押品的时候，所有 CDP 持有者能赎回当前 CDP 净值对应的抵押品。

举个例子：

>如果你的 CDP 为价值 300 美元的 1个 ETH 和100 美元的负债，那么你将获得 0.6666 ETH 且消除债务。
> 可赎回的 CDP 净值就是价值 300 美元的抵押品，减去 100 美元的债务。
> 因此，在6个小时的延迟期后，你可赎回 0.6666 ETH。

## 有什么方式可防止 MKR 持有者为了避免 MKR 因管理不善稀释，而触发紧急关停?

MKR 持有者，特别是大规模持有者，有激励去维持 MKR 的价值。如果是由于担心 MKR 稀释，而执行紧急关停，这可能会让其失去 MKR 所有权。因为任何人都可重新部署系统并更改 MKR 的代币分配。因此，对于攻击者而言，这是一个成本很高的选项。

## 我可以在紧急关停期内创建 CDP 吗?

不可以。

## 对于丢失私钥，无法操作的 CDP 和 Dai 该怎么处理?

保持原样，其背后的抵押品也会保持原样。

## 紧急关停情况下会免除稳定费吗?

紧急关停情况下无需支付稳定费。对于不想迁移到多抵押 CDP，而试图通过紧急关停而避免支付稳定费的 CDP 持有者，系统可向其征收高额 “紧急关停罚金”。这意味着支付稳定费，正常迁移到 MCD 始终是更明智的选择。

## 紧急关停在历史上启动过吗?

是的，在升级到单抵押 Dai之前，Sai 系统（单抵押 Dai 的雏形）曾[执行](https://www.reddit.com/r/MakerDAO/comments/7lhbmx/psa_sai_now_globally_settled/)过紧急关停。

## 如何测试紧急关停?

紧急关停最初是在 Sai 部署中采用和测试。除了对[代码](https://github.com/makerdao/sai/blob/master/src/sai.t.sol)进行测试外，还有三次实际运行，都发生在以太坊主网上 Sai 雏形部署时。

## CDP 用户和 Dai 持有者怎么样收到紧急关停的通知?

Maker 所有官方平台和博客以及 Twitter、Medium、Rocketchat、Telegram、微信公众号、 Kakaotalk 等社交渠道都会进行通知。